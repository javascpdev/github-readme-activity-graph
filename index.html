<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>GitHub Readme Activity Graph</title>
    <link rel="preconnect" href="https://fonts.gstatic.com" />
    <link
      href="https://fonts.googleapis.com/css2?family=PT+Sans&display=swap"
      rel="stylesheet"
    />
  </head>
  <style>
    :root {
      background: #f5f6fa;
      color: #9c9c9c;
      font: 1rem 'PT Sans', sans-serif;
    }
    body {
      height: 90vh;
    }
    html,
    body,
    a {
      color: inherit;
    }
    a:hover {
      color: #7f8ff4;
    }
    p {
      color: white;
    }
    .container {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      height: 100%;
    }
    .uppercase {
      text-transform: uppercase;
    }
    .btn {
      display: inline-block;
      background: transparent;
      color: inherit;
      font: inherit;
      border: 0;
      outline: 0;
      padding: 0;
      transition: all 200ms ease-in;
      cursor: pointer;
    }
    .btn--primary {
      background: #7f8ff4;
      color: #fff;
      box-shadow: 0 0 10px 2px rgba(0, 0, 0, 0.1);
      border-radius: 2px;
      padding: 12px 36px;
    }
    .btn--primary:hover {
      background: #6c7ff2;
    }
    .btn--primary:active {
      background: #7f8ff4;
      box-shadow: inset 0 0 10px 2px rgba(0, 0, 0, 0.2);
    }
    .btn--inside {
      margin-left: -96px;
    }
    .form__field {
      width: 360px;
      background: #fff;
      color: #a3a3a3;
      font: inherit;
      box-shadow: 0 6px 10px 0 rgba(0, 0, 0, 0.1);
      border: 0;
      outline: 0;
      padding: 22px 18px;
    }

    @keyframes blink {
      from {
        opacity: 0;
        transform: translateX(-20px);
      }
      to {
        opacity: 1;
        transform: translateX(0);
      }
    }

    @keyframes dash {
      to {
        stroke-dashoffset: 0;
      }
    }

    .ct-label {
      fill: #5bcdec;
      color: #5bcdec;
      font-size: 0.75rem;
      line-height: 1;
    }

    .ct-grid-background,
    .ct-line {
      fill: none;
    }

    .ct-chart-bar .ct-label,
    .ct-chart-line .ct-label {
      display: block;
      display: -webkit-box;
      display: -moz-box;
      display: -ms-flexbox;
      display: -webkit-flex;
      display: flex;
    }

    .ct-label.ct-horizontal.ct-start {
      -webkit-box-align: flex-end;
      -webkit-align-items: flex-end;
      -ms-flex-align: flex-end;
      align-items: flex-end;
      -webkit-box-pack: flex-start;
      -webkit-justify-content: flex-start;
      -ms-flex-pack: flex-start;
      justify-content: flex-start;
      text-align: left;
      text-anchor: start;
    }

    .ct-label.ct-horizontal.ct-end {
      -webkit-box-align: flex-start;
      -webkit-align-items: flex-start;
      -ms-flex-align: flex-start;
      align-items: flex-start;
      -webkit-box-pack: flex-start;
      -webkit-justify-content: flex-start;
      -ms-flex-pack: flex-start;
      justify-content: flex-start;
      text-align: left;
      text-anchor: start;
    }

    .ct-label.ct-vertical.ct-start {
      -webkit-box-align: flex-end;
      -webkit-align-items: flex-end;
      -ms-flex-align: flex-end;
      align-items: flex-end;
      -webkit-box-pack: flex-end;
      -webkit-justify-content: flex-end;
      -ms-flex-pack: flex-end;
      justify-content: flex-end;
      text-align: right;
      text-anchor: end;
    }

    .ct-label.ct-vertical.ct-end {
      -webkit-box-align: flex-end;
      -webkit-align-items: flex-end;
      -ms-flex-align: flex-end;
      align-items: flex-end;
      -webkit-box-pack: flex-start;
      -webkit-justify-content: flex-start;
      -ms-flex-pack: flex-start;
      justify-content: flex-start;
      text-align: left;
      text-anchor: start;
    }

    .ct-grid {
      stroke: #5bcdec;
      stroke-width: 1px;
      stroke-opacity: 0.3;
      stroke-dasharray: 2px;
    }

    .ct-point {
      stroke-width: 10px;
      stroke-linecap: round;
      stroke: #ffffff;
      animation: blink 1s ease-in-out forwards;
    }

    .ct-line {
      stroke-width: 4px;
      stroke-dasharray: 5000;
      stroke-dashoffset: 5000;
      stroke: #5bcdec;
      animation: dash 5s ease-in-out forwards;
    }

    .ct-area {
      stroke: none;
      fill-opacity: 0.1;
    }

    .ct-series-a .ct-area,
    .ct-series-a .ct-slice-pie {
      fill: skyblue;
    }

    .ct-label .ct-horizontal {
      transform: rotate(-90deg);
    }

    .ct-axis-title {
      fill: #ffffff;
    }

    .rect {
      width: 90%;
      padding: auto;
      background-color: #2e3440;
      margin-top: 2rem;
      border-radius: 4px;
    }

    .split_container {
      display: flex;
      width: 100%;
      height: 100%;
    }

    .left {
      width: 30%;
      margin-right: 2rem;
      display: flex;
      flex-direction: column;
      justify-content: space-evenly;
    }

    .right {
      width: 100%;
    }

    .form {
      margin: auto;
      width: 50%;
    }

    .picker {
      margin-left: 1rem;
    }
  </style>
  <body>
    <div class="container">
      <h1>GitHub Readme Activity Graph</h1>
      <div class="split_container">
        <section class="left">
          <form>
            <input
              type="color"
              class="picker"
              name="bgColor"
              value="#2e3440"
              id="bgColor"
            />
            <label for="bgColor">Background Color</label>
          </form>
          <div>
            <input
              type="color"
              class="picker"
              name="line"
              value="#5bcdec"
              id="line"
            />
            <label for="line">Line Color</label>
          </div>
          <div>
            <input
              type="color"
              class="picker"
              name="point"
              value="#ffffff"
              id="point"
            />
            <label for="point">Point Color</label>
          </div>
          <div>
            <input
              type="color"
              class="picker"
              name="color"
              value="#5bcdec"
              id="color"
            />
            <label for="color">Text Color</label>
          </div>
        </section>
        <section class="right">
          <div class="container__item">
            <form class="form">
              <input
                type="username"
                class="form__field"
                placeholder="Your GitHub Username"
                id="username"
              />
              <button
                type="button"
                class="btn btn--primary btn--inside uppercase"
                id="submit-button"
              >
                Build Graph
              </button>
            </form>
          </div>
          <div class="rect">
            <div class="ct-chart"></div>
          </div>
        </section>
      </div>
    </div>
  </body>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/chartist/0.11.4/chartist.min.js"></script>
  <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chartist-plugin-axistitle@0.0.7/dist/chartist-plugin-axistitle.min.js"></script>
  <script>
    //Get submit button
    let submitButton = document.getElementById('submit-button');
    //on click event
    submitButton.addEventListener('click', (event) => {
      //get username
      var username = document.getElementById('username').value;
      //API call
      const graphqlQuery = {
        query: `
                query userInfo($LOGIN: String!) {
                user(login: $LOGIN) {
                    name
                    contributionsCollection {
                    contributionCalendar {
                        totalContributions
                        weeks {
                            contributionDays {
                            contributionCount
                            }
                        }
                        }
                    }
                    }
                },
                `,
        variables: {
          LOGIN: username,
        },
      };
      //set auth header
      const headers = {
        Authorization: 'bearer 09065429d04927ea6fb2156d190b0e1a833b8df0',
      };
      //get user data
      axios({
        url: 'https://api.github.com/graphql',
        method: 'POST',
        headers,
        data: graphqlQuery,
      })
        .then((apiResponse) => {
          if (apiResponse.data.data.user === null)
            alert(
              `Can't fetch any contribution. Please check your username ðŸ˜¬`
            );
          else {
            let userData = {
              contributions: [],
              name: apiResponse.data.data.user.name,
            };
            //filtering the week data from API response
            const weeks =
              apiResponse.data.data.user.contributionsCollection
                .contributionCalendar.weeks;
            //slicing last 6 weeks
            weeks.slice(weeks.length - 6, weeks.length).map((week) =>
              week.contributionDays.map((contributionCount) => {
                userData.contributions.push(
                  contributionCount.contributionCount
                );
              })
            );
            //returning data of last 31 days
            const presentDay = new Date().getDay();
            userData.contributions = userData.contributions.slice(
              5 + presentDay,
              36 + presentDay
            );
            var data = {
              labels: [
                ...Array(userData.contributions.length + 1).keys(),
              ].slice(1),
              series: [{ value: userData.contributions }],
            };
            const options = {
              width: 1000,
              height: 380,
              axisY: {
                title: 'Contributions',
                onlyInteger: true,
                offset: 70,
                labelOffset: {
                  y: 4.5,
                },
              },
              axisX: {
                title: 'Days',
                offset: 50,
                labelOffset: {
                  x: -4.5,
                },
              },
              chartPadding: {
                top: 80,
                right: 50,
                bottom: 20,
                left: 20,
              },
              showArea: true,
              fullWidth: true,
              plugins: [
                Chartist.plugins.ctAxisTitle({
                  axisX: {
                    axisTitle: 'Days',
                    axisClass: 'ct-axis-title',
                    offset: {
                      x: 0,
                      y: 50,
                    },
                    textAnchor: 'middle',
                  },
                  axisY: {
                    axisTitle: 'Contributions',
                    axisClass: 'ct-axis-title',
                    offset: {
                      x: 0,
                      y: 50,
                    },
                    textAnchor: 'middle',
                    flipTitle: true,
                  },
                }),
              ],
            };
            new Chartist.Line('.ct-chart', data, options);
          }
        })
        .catch((err) => console.error(err));
    });
    //Dynamic changes
    //Background
    let bgInput = document.getElementById('bgColor');
    bgInput.addEventListener('input', function () {
      document.querySelector('.rect').style.backgroundColor = bgInput.value;
    });
    //line
    function line() {
      let theInput = document.getElementById('line');
      theInput.addEventListener('input', function () {
        document.querySelector('.ct-line').style.stroke = theInput.value;
      });
    }
    //color
    function color() {
      let theInput = document.getElementById('color');
      theInput.addEventListener('input', function () {
        let allLables = document.querySelectorAll('.ct-label');
        var index = 0,
          length = allLables.length;
        for (; index < length; index++) {
          allLables[index].style.fill = theInput.value;
          allLables[index].style.color = theInput.value;
        }
      });

      theInput.addEventListener('input', function () {
        let allLables = document.querySelectorAll('.ct-axis-title');
        var index = 0,
          length = allLables.length;
        for (; index < length; index++) {
          allLables[index].style.fill = theInput.value;
        }
      });

      theInput.addEventListener('input', function () {
        let allLables = document.querySelectorAll('.ct-grid');
        var index = 0,
          length = allLables.length;
        for (; index < length; index++) {
          allLables[index].style.stroke = theInput.value;
        }
      });
    }
    //point
    function point() {
      let pointInput = document.getElementById('point');
      pointInput.addEventListener('input', function () {
        let allPointLables = document.querySelectorAll('.ct-point');
        var idx = 0,
          len = allPointLables.length;
        for (; idx < len; idx++) {
          allPointLables[idx].style.stroke = pointInput.value;
        }
      });
    }

    //calling
    line();
    color();
    point();
  </script>
</html>
